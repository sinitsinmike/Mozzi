<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Mozzi: Mozzi on ESP32-based boards.</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="custom_stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="mozzi-circle.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Mozzi
   &#160;<span id="projectnumber">version v2.0</span>
   </div>
   <div id="projectbrief">sound synthesis library for Arduino</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('hardware_esp32.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Mozzi on ESP32-based boards. </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>port by Dieter Vandoren and Thomas Friedrichsmeier</p>
<h1><a class="anchor" id="esp32_status"></a>
Port status and notes</h1>
<ul>
<li>Since flash memory is not built into the ESP32, but connected, externally, it is much too slow for keeping wave tables, audio samples, etc. Instead, these are kept in RAM on this platform.</li>
<li>Asynchronous analog reads are not implemented. <code><a class="el" href="group__analog.html#gadedb573129313bad0c183af2486c5283" title="See mozziAnalogRead().">mozziAnalogRead()</a></code> relays to <code>analogRead()</code>. <a class="el" href="group__config.html#ga40857197e27e3b4d3ee7177e95f59d6d">MOZZI_AUDIO_INPUT</a> is not implemented</li>
<li>twi_nonblock is not ported</li>
<li>WIFI-activity not yet tested, but likely the same notes as for ESP8266 apply, i.e. <em>any</em> Wifi activity is likely to introdcue considerable nose. Consider turning off WIFI.</li>
<li>The implementation of <a class="el" href="group__core.html#ga55fa9d48f327b646c2f71cef7da7b8f0" title="An alternative for Arduino time functions like micros() and millis().">audioTicks()</a> may be slightly inaccurate on this platform.</li>
</ul>
<h1><a class="anchor" id="esp32_output"></a>
Output modes</h1>
<p>The following audio modes (see <a class="el" href="group__config.html#ga9b14b158a7a469612a89dcc9630933b7">MOZZI_AUDIO_MODE</a>) are currently supported on this hardware:</p><ul>
<li>MOZZI_OUTPUT_EXTERNAL_TIMED</li>
<li>MOZZI_OUTPUT_EXTERNAL_CUSTOM</li>
<li>MOZZI_OUTPUT_PDM_VIA_I2S</li>
<li>MOZZI_OUTPUT_I2S_DAC</li>
<li>MOZZI_OUTPUT_INTERNAL_DAC</li>
</ul>
<p>The default mode is <a class="el" href="hardware_esp32.html#esp32_internal_dac">MOZZI_OUTPUT_INTERNAL_DAC</a> .</p>
<h1><a class="anchor" id="esp32_internal_dac"></a>
MOZZI_OUTPUT_INTERNAL_DAC</h1>
<p>The internal DAC has 8 bit resolution, and outputs to GPIO pins 25 and 26 (non-configurable). For simplicity of code, both pins are always used. In a mono configuration, both pins output the same sample.</p>
<p>TODO: We could really use this to hack in a 2 PIN mode!</p>
<dl class="section note"><dt>Note</dt><dd>The number 25 refers to "GPIO 25" or sometimes labelled "D25". Confusingly, many boards come with an additional, totally different numbering scheme on top of that. Check a detailed pinout diagram, if in any doubt.</dd></dl>
<p>Internally, the inbuilt DAC is connected via an I2S interface. Which interface number to use can be configured using:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#define MOZZI_I2S_PORT     ... </span><span class="comment">// (default: I2S_NUM_0)</span></div>
</div><!-- fragment --><h1><a class="anchor" id="esp32_i2s_dac"></a>
MOZZI_OUTPUT_I2S_DAC</h1>
<p>This mode outputs to a PT8211 (or compatible) I2S DAC, which allows for very high quality (mono or stereo) output. Communication needs the BCK, WS, and DATA(out) pins of one I2S interface. Presumably, any pins qualify, and you can configure this using: </p><div class="fragment"><div class="line"><span class="preprocessor">#define MOZZI_I2S_PIN_BCK  ... </span><span class="comment">// (default: 26)</span></div>
<div class="line"><span class="preprocessor">#define MOZZI_I2S_PIN_WS   ... </span><span class="comment">// (default: 15)</span></div>
<div class="line"><span class="preprocessor">#define MOZZI_I2S_PIN_DATA ... </span><span class="comment">// (default: 33)</span></div>
<div class="line">#define MOZZI_I2S_PORT     ... <span class="comment">// (default: I2S_NUM_0)</span></div>
</div><!-- fragment --><p>See the note above (esp_internal_dac) regarding pin numbering. Also, please always test the default pinout, should a custom setting fail!</p>
<p>As a technical note, I2S support in the ESP32 SDK has been reworked since this was implemented in Mozzi, and Mozzi uses the "legacy" implementation "i2s.h". This should not be an issue, unless you want to connect additional I2S components, yourself. In which case contributions are certainly welcome!</p>
<h1><a class="anchor" id="esp32_pdm_via_i2s"></a>
MOZZI_OUTPUT_PDM_VIA_I2S</h1>
<p>This mode uses the same setup as <a class="el" href="hardware_esp32.html#esp32_i2s_dac">MOZZI_OUTPUT_I2S_DAC</a>, but rather than using an external DAC, the communication signal itself is modulated in PDM (pulse density modulation) encoded form. Thus not extra hardware is needed, and the signal is output on the DATA pin (see above). The BCK and WS pins are also claimed, but should be left non-connected, and do not produce anything meaningful. This can only be used in mono mode.</p>
<p>Output resolution may be adjusted by defining MOZZI_PDM_RESOLUTION , where the default value of 4 means that each audio sample is encoded into four 32 bit blocks of ones and zeros. Obviously, more is potentially better, but at the cost of considerable computation power.</p>
<h1><a class="anchor" id="esp32_external"></a>
MOZZI_OUTPUT_EXTERNAL_TIMED and MOZZI_OUTPUT_EXTERNAL_CUSTOM</h1>
<p>See <a class="el" href="group__audio__output.html">External audio output</a> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<div id="nav-path" class="navpath">
<ul><li class="footer">Generated automatically using Doxygen. If info on this page is outdated, incomplete, or wrong, please open an issue at https://github.com/sensorium/Mozzi/issues</li></ul>
</div>
</body>
</html>
